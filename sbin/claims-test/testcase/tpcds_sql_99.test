select    substr(w_warehouse_name,1,20) as A
  ,sm_type
  ,cc_name 
  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as adays
  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and
                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as  bdays
  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and
                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as  cdays
  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) an
                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as ddays
  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as fdays
from
  warehouse
  ,ship_mode 
  ,call_center
  ,date_dim 
, catalog_sales
where
    d_month_seq between 1193 and 1204
and cs_ship_date_sk   = d_date_sk
and cs_warehouse_sk   = w_warehouse_sk
and cs_ship_mode_sk   = sm_ship_mode_sk
and cs_call_center_sk = cc_call_center_sk
group by
   A  ,sm_type
  ,cc_name
order by A        ,sm_type
        ,cc_name
limit 100;
exit;